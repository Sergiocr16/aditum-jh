<div ng-if="!vm.isReady" layout="row" class="content-loader" layout-sm="column" layout-fill
     layout-align="space-around center">
    <md-progress-circular md-mode="indeterminate" md-diameter="90px"></md-progress-circular>
</div>

<div ng-if="vm.isReady" ng-cloak layout="column"
     class="md-inline-form col-md-12 col-lg-12  col-sm-12 col-xs-12 form-wrapper no-padding fade-in no-margin-top-xs-sm">

    <md-toolbar class="form-title" hide-sm hide-xs layout-align="space-between center" layout="row">
        <h2>{{vm.button}} área común</h2>

    </md-toolbar>
    <md-content>
        <div>
            <form name="form" ng-submit=" vm.confirmMessage()">
                <span ng-hide="true">{{setInvalidForm(form.$invalid)}}</span>
                <div layout="column" layout-xs="column">
                    <div flex class="col-lg-12 col-md-12 col-sm-12 white-bg divFormsMDXS padding-30">
                        <md-input-container class="md-block">
                            <label>Nombre del área común</label>
                            <input type="text" class="form-control" name="name" id="field_common_area"
                                   ng-model="vm.commonArea.name"
                                   required/>
                        </md-input-container>
                        <md-input-container class="md-block">
                            <label>Descripción</label>
                            <textarea name="description" id="field_description" ng-model="vm.commonArea.description"
                                      placeholder="Ubicación, reglas del área común, etc." style="margin-top: -5px;"
                                      rows="3" md-select-on-focus></textarea>
                        </md-input-container>
                        <md-input-container class="md-block " ng-if="vm.hasContability">
                            <div style="margin-top: 25px!important;">
                                <label>Modo de reservación</label>
                            </div>
                            <div class="col-md-12 no-padding" style="margin-top: 13px;">
                                <md-radio-group style="padding-top: 25px!important;"
                                                ng-model="vm.commonArea.hasBlocks">
                                    <md-radio-button value="0" class="col-md-4 col-xs-4  outline-none md-primary">
                                        Horario corrido
                                    </md-radio-button>
                                    <md-radio-button value="1" class="col-md-4 col-xs-4  outline-none"> Bloques
                                    </md-radio-button>

                                </md-radio-group>

                            </div>
                        </md-input-container>

                        <md-input-container class="md-block" ng-if="vm.commonArea.hasBlocks==0">
                            <label>Tiempo máximo de uso</label>
                            <md-select ng-model="vm.commonArea.maximunHours" name="maximunHours" required>
                                <md-option ng-value="bloque.value" ng-repeat="bloque in vm.bloques">
                                    {{bloque.hour}}
                                </md-option>
                            </md-select>
                        </md-input-container>

                        <md-input-container ng-if="vm.commonArea.hasBlocks!=null" class="md-block" flex hide-xs>
                            <div style="margin-bottom: 25px;">
                                <label>Días permitidos para reservar</label>
                            </div>
                            <div>

                                <md-checkbox ng-model="vm.lunesSelected" ng-click="vm.selectDay(0)"
                                             class="col-md-6 col-xs-6">
                                    Lunes
                                </md-checkbox>
                                <md-checkbox ng-model="vm.viernesSelected" ng-click="vm.selectDay(4)"
                                             class="col-md-6 col-xs-6">
                                    Viernes
                                </md-checkbox>
                                <md-checkbox ng-model="vm.martesSelected" ng-click="vm.selectDay(1)"
                                             class="col-md-6 col-xs-6">
                                    Martes
                                </md-checkbox>
                                <md-checkbox ng-model="vm.sabadoSelected" ng-click="vm.selectDay(5)"
                                             class="col-md-6 col-xs-6">
                                    Sábado
                                </md-checkbox>
                                <md-checkbox ng-model="vm.miercolesSelected" ng-click="vm.selectDay(2)"
                                             class="col-md-6 col-xs-6">
                                    Miercoles
                                </md-checkbox>
                                <md-checkbox ng-model="vm.domingoSelected" ng-click="vm.selectDay(6)"
                                             class="col-md-6 col-xs-6">
                                    Domingo
                                </md-checkbox>
                                <md-checkbox ng-model="vm.juevesSelected" ng-click="vm.selectDay(3)"
                                             class="col-md-6 col-xs-6">
                                    Jueves
                                </md-checkbox>


                            </div>
                        </md-input-container>

                        <md-input-container ng-if="vm.commonArea.hasBlocks!=null"
                                            class="md-block hidden-sm hidden-lg hidden-md" flex hide-md hide-sm
                                            hide-lg>
                            <div style="margin-bottom: 25px;">
                                <label>Días permitidos para reservar</label>
                            </div>
                            <div>

                                <md-checkbox ng-model="vm.lunesSelected" ng-click="vm.selectDay(0)"
                                             class="col-md-6 col-xs-6">
                                    Lunes
                                </md-checkbox>
                                <md-checkbox ng-model="vm.martesSelected" ng-click="vm.selectDay(1)"
                                             class="col-md-6 col-xs-6">
                                    Martes
                                </md-checkbox>
                                <md-checkbox ng-model="vm.miercolesSelected" ng-click="vm.selectDay(2)"
                                             class="col-md-6 col-xs-6">
                                    Miercoles
                                </md-checkbox>
                                <md-checkbox ng-model="vm.juevesSelected" ng-click="vm.selectDay(3)"
                                             class="col-md-6 col-xs-6">
                                    Jueves
                                </md-checkbox>

                                <md-checkbox ng-model="vm.viernesSelected" ng-click="vm.selectDay(4)"
                                             class="col-md-6 col-xs-6">
                                    Viernes
                                </md-checkbox>
                                <md-checkbox ng-model="vm.sabadoSelected" ng-click="vm.selectDay(5)"
                                             class="col-md-6 col-xs-6">
                                    Sábado
                                </md-checkbox>

                                <md-checkbox ng-model="vm.domingoSelected" ng-click="vm.selectDay(6)"
                                             class="col-md-6 col-xs-6">
                                    Domingo
                                </md-checkbox>


                            </div>
                        </md-input-container>

                        <div ng-if="item.selected && vm.commonArea.hasBlocks==0" ng-repeat="item in vm.daysOfWeek">
                            <div class="col-md-12 no-padding margin-bottom-10"><label>Horas permitidas para reservar el
                                {{item.day}} </label></div>

                            <div class="col-md-6 no-padding-left">
                                <md-input-container class="md-block">
                                    <label>Hora de inicio</label>
                                    <md-select ng-change="vm.validateDaysHours($index,item)" ng-model="item.initialTime"
                                               name="maximunHours" required>
                                        <md-option required
                                                   ng-model="item.initialTime" ng-value="hour.value"
                                                   ng-repeat="hour in vm.hours">
                                            {{hour.time}}
                                        </md-option>
                                    </md-select>


                                </md-input-container>

                            </div>
                            <div class="col-md-6 no-padding">
                                <md-input-container class="md-block"
                                                    ng-class="{'md-input-invalid': item.isValid==false}">
                                    <label>Hora de fin</label>
                                    <md-select ng-change="vm.validateDaysHours($index,item)" ng-model="item.finalTime"
                                               name="maximunHours" required>
                                        <md-option required
                                                   ng-model="item.finalTime" ng-value="hour.value"
                                                   ng-repeat="hour in vm.hours">
                                            {{hour.time}}
                                        </md-option>
                                    </md-select>
                                </md-input-container>
                            </div>
                        </div>
<<<<<<< HEAD
=======
                    </div>
                    <div flex class="col-lg-6 col-md-6 col-sm-6 white-bg divFormsMDXS">
                        <md-input-container class="md-block">
                            <label>Descripción</label>
                            <textarea name="description" id="field_description" ng-model="vm.commonArea.description"
                                      placeholder="Ubicación, reglas del área común, etc." style="margin-top: -5px;"
                                      rows="3" md-select-on-focus></textarea>
                        </md-input-container>
                        <md-input-container class="md-block" ng-if="vm.hasContability">
                            <div style="margin-top: 25px!important;">
                                <label>Requiere cobro</label>
                            </div>
                            <div class="col-md-12 no-padding" style="margin-top: 13px;">
                                <md-radio-group style="padding-top: 25px!important;"
                                                ng-model="vm.commonArea.chargeRequired">

                                    <md-radio-button value="1" class="col-md-2 col-xs-4 outline-none md-primary"
                                                     >Si
                                    </md-radio-button>
                                    <md-radio-button value="0" class="col-md-2 col-xs-4 outline-none">
                                        No
                                    </md-radio-button>

                                </md-radio-group>
>>>>>>> 0c89155a57b73b9a53efbcc3345bc0692097be93

                        <div ng-if="item.selected && vm.commonArea.hasBlocks==1" ng-repeat="item in vm.daysOfWeek"
                             class="margin-top-30">
                            <div class="col-md-12 col-sm-12 col-xs-12 no-padding-left">
                                <h2 class=" font-green-sharp font-weight-600"
                                    style="font-size:20px">
                                    Bloques del {{item.day}}
                                </h2>
                            </div>
                            <md-button class=" md-raised fileinput-new no-margin-left float-right" type="button"
                                       ng-click="
                                       vm.addBlockToDay(item)">
                                Agregar bloque
                            </md-button>
                            <div ng-if="block.selected" ng-repeat="block in item.blocks">
                                <div class="col-md-12 no-padding margin-bottom-10 "><label>Horario bloque
                                    {{$index+1}} </label></div>
                                <div class="col-md-5 no-padding-left">
                                    <md-input-container class="md-block">
                                        <label>Hora de inicio</label>
                                        <md-select ng-change="vm.validateDaysHours($index,block)"
                                                   ng-model="block.initialTime"
                                                   name="maximunHours" required>
                                            <md-option required
                                                       ng-model="block.initialTime" ng-value="hour.value"
                                                       ng-repeat="hour in vm.hours">
                                                {{hour.time}}
                                            </md-option>
                                        </md-select>


                                    </md-input-container>

                                </div>
                                <div class="col-md-6 no-padding">
                                    <md-input-container class="md-block"
                                                        ng-class="{'md-input-invalid': block.isValid==false}">
                                        <label>Hora de fin</label>
                                        <md-select ng-change="vm.validateDaysHours($index,block)"
                                                   ng-model="block.finalTime"
                                                   name="maximunHours" required>
                                            <md-option required
                                                       ng-model="block.finalTime" ng-value="hour.value"
                                                       ng-repeat="hour in vm.hours">
                                                {{hour.time}}
                                            </md-option>
                                        </md-select>
                                    </md-input-container>
                                </div>
                                <div class="margin-top-20 col-md-1 text-center">
                                    <h4 class="text-center">
                                        <md-icon
                                            class="red-icon-button-oficial col-xs-1 text-center"
                                            ng-click="vm.deleteBlock(block)">
                                            <md-tooltip md-direction="top" class="font-13 bold white-color">Eliminar
                                            </md-tooltip>
                                            delete
                                        </md-icon>
                                    </h4>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-6 col-md-6 col-sm-6 col-xs-12 no-padding ">
                            <md-button class=" md-raised fileinput-new no-margin-left " type="button" ngf-select
                                       ngf-change="vm.setPicture($file, vm.commonArea)">
                                Subir imagen
                            </md-button>

                            <div class="form-group" ngf-drop
                                 ngf-change="vm.setPicture($file, vm.commonArea)" ngf-pattern="'image/*'">

                                <div class="margin-top-10">
                                    <img
                                        data-ng-src="{{'data:' + vm.commonArea.pictureContentType + ';base64,' + vm.commonArea.picture}}"
                                        style="width: 100%;" ng-if="vm.commonArea.picture"
                                        alt="commonArea image"/>


                                </div>
                                <input type="hidden" class="form-control " name="picture" id="field_picture"
                                       ng-model="vm.commonArea.picture"
                                />
                                <input type="hidden" class="form-control" name="pictureContentType"
                                       id="field_pictureContentType"
                                       ng-model="vm.commonArea.pictureContentType"/>
                            </div>
                        </div>

                    </div>

                </div>
                <div layout="column" layout-xs="column">
                    <md-toolbar class="form-title">
                        <h2>Restricciones del área común</h2>
                    </md-toolbar>
                    <div flex class="col-lg-12 col-md-12 col-sm-12 white-bg divFormsMDXS padding-30">
                        <div class="col-md-6 col-sm-6 col-xs-6 no-padding-left">
                            <div class="col-md-12 col-sm-12 col-xs-12 no-padding">
                                <md-input-container class="md-block">
                                    <div style="margin-top: 25px!important;">
                                        <label>Requiere aprobación por el administrador</label>
                                    </div>
                                    <div class="col-md-12 no-padding" style="margin-top: 13px;">
                                        <md-radio-group style="padding-top: 25px!important;"
                                                        ng-model="vm.commonArea.needsApproval">

                                            <md-radio-button value="1" class="col-md-2 col-xs-4 outline-none md-primary"
                                            >Si
                                            </md-radio-button>
                                            <md-radio-button value="0" class="col-md-2 col-xs-4 outline-none">
                                                No
                                            </md-radio-button>

                                        </md-radio-group>

                                    </div>
                                </md-input-container>
                            </div>
                            <div class="col-md-12 col-sm-12 col-xs-12 no-padding">
                                <md-input-container class="md-block" ng-if="vm.hasContability">
                                    <div style="margin-top: 25px!important;">
                                        <label>Requiere cobro</label>
                                    </div>
                                    <div class="col-md-12 no-padding" style="margin-top: 13px;">
                                        <md-radio-group style="padding-top: 25px!important;"
                                                        ng-model="vm.commonArea.chargeRequired">

                                            <md-radio-button value="1" class="col-md-2 col-xs-4 outline-none md-primary"
                                            >Si
                                            </md-radio-button>
                                            <md-radio-button value="0" class="col-md-2 col-xs-4 outline-none">
                                                No
                                            </md-radio-button>

                                        </md-radio-group>

                                    </div>
                                </md-input-container>
                            </div>

                            <div class="col-md-12 col-sm-12 col-xs-12 no-padding">
                                <md-input-container class="md-block margin-top-20 col-md-12 no-padding"
                                                    ng-if="vm.commonArea.chargeRequired==1">
                                    <label>Cuota por reservación</label>
                                    <input type="text" class="form-control" format="currency" placeholder="0.00"
                                           ng-model="vm.commonArea.reservationCharge"
                                           required
                                    />
                                </md-input-container>

                                <md-input-container class="md-block margin-top-20 col-md-12 no-padding"
                                                    ng-if="vm.commonArea.chargeRequired==1">
                                    <label>Dinero a devolver una vez utilizado</label>
                                    <input type="text" class="form-control" format="currency" placeholder="0.00"
                                           ng-model="vm.commonArea.devolutionAmmount"
                                           required
                                    />
                                </md-input-container>
                            </div>
                            <div class="col-md-12 col-sm-12 col-xs-12 no-padding">
                                <md-input-container class="md-block" ng-if="vm.hasContability">
                                    <div style="margin-top: 25px!important;">
                                        <label>Permite reservar con deudas</label>
                                    </div>
                                    <div class="col-md-12 no-padding" style="margin-top: 13px;">
                                        <md-radio-group style="padding-top: 25px!important;"
                                                        ng-model="vm.commonArea.reservationWithDebt">
                                            <md-radio-button value="1"
                                                             class="col-md-2 col-xs-4  outline-none md-primary">Si
                                            </md-radio-button>
                                            <md-radio-button value="2" class="col-md-2 col-xs-4  outline-none"> No
                                            </md-radio-button>

                                        </md-radio-group>

                                    </div>
                                </md-input-container>
                            </div>
                            <div class="col-md-12 col-sm-12 col-xs-12 no-padding">
                                <md-input-container class="md-block">
                                    <div style="margin-top: 25px!important;">
                                        <label>Se reserva con días de antelación</label>
                                    </div>
                                    <div class="col-md-12 no-padding" style="margin-top: 13px;">
                                        <md-radio-group style="padding-top: 25px!important;"
                                                        ng-model="vm.commonArea.hasDaysBeforeToReserve">
                                            <md-radio-button value="1"
                                                             class="col-md-2 col-xs-4  outline-none md-primary">Si
                                            </md-radio-button>
                                            <md-radio-button value="0" class="col-md-2 col-xs-4  outline-none"> No
                                            </md-radio-button>

                                        </md-radio-group>

                                    </div>
                                </md-input-container>
                                <md-input-container class="md-block margin-top-20 col-md-12 no-padding"
                                                    ng-if="vm.commonArea.hasDaysBeforeToReserve==1">
                                    <label>Días de antelación para reservar</label>
                                    <input type="number" class="form-control"
                                           ng-model="vm.commonArea.daysBeforeToReserve"
                                           required
                                    />
                                </md-input-container>
                            </div>

                        </div>
                        <div class="col-md-6 col-sm-6 col-xs-6">
                            <div class="col-md-12 col-sm-12 col-xs-12 no-padding">
                                <md-input-container class="md-block">
                                    <div style="margin-top: 25px!important;">
                                        <label>Se reserva días antes si no está reservado aún</label>
                                    </div>
                                    <div class="col-md-12 no-padding" style="margin-top: 13px;">
                                        <md-radio-group style="padding-top: 25px!important;"
                                                        ng-model="vm.commonArea.hasDaysToReserveIfFree">
                                            <md-radio-button value="1"
                                                             class="col-md-2 col-xs-4  outline-none md-primary">Si
                                            </md-radio-button>
                                            <md-radio-button value="0" class="col-md-2 col-xs-4  outline-none"> No
                                            </md-radio-button>

                                        </md-radio-group>

                                    </div>
                                </md-input-container>
                                <md-input-container class="md-block margin-top-20 col-md-5 no-padding margin-right-10"
                                                    ng-if="vm.commonArea.hasDaysToReserveIfFree==1">
                                    <label>Días de antelación mínimo</label>
                                    <input type="number" class="form-control" ng-change="vm.validateDaysToReserveIfFree()"
                                           ng-model="vm.commonArea.daysToReserveIfFreeMinimun"   ng-class="{'md-input-invalid': vm.commonArea.daysToReserveIfFreeMaximunValid == false}"
                                           required
                                    />

                                </md-input-container>
                                <md-input-container class="md-block margin-top-20 col-md-6 no-padding"
                                                    ng-if="vm.commonArea.hasDaysToReserveIfFree==1">
                                    <label>Días de antelación máximo</label>
                                    <input type="number" class="form-control"   ng-change="vm.validateDaysToReserveIfFree()" ng-class="{'md-input-invalid':  vm.commonArea.daysToReserveIfFreeMaximunValid == false}"
                                           ng-model="vm.commonArea.daysToReserveIfFreeMaximun"
                                           required
                                    />

                                </md-input-container>
                            </div>
                            <div class="col-md-12 col-sm-12 col-xs-12 no-padding">
                                <md-input-container class="md-block">
                                    <div style="margin-top: 25px!important;">
                                        <label>Se reserva con distancía de tiempo entre reservaciones</label>
                                    </div>
                                    <div class="col-md-12 no-padding" style="margin-top: 13px;">
                                        <md-radio-group style="padding-top: 25px!important;"
                                                        ng-model="vm.commonArea.hasDistanceBetweenReservations">
                                            <md-radio-button value="1"
                                                             class="col-md-2 col-xs-4  outline-none md-primary">Si
                                            </md-radio-button>
                                            <md-radio-button value="0" class="col-md-2 col-xs-4  outline-none"> No
                                            </md-radio-button>

                                        </md-radio-group>

                                    </div>
                                </md-input-container>
                                <md-input-container class="md-block margin-top-20 col-md-12 no-padding"
                                                    ng-if="vm.commonArea.hasDistanceBetweenReservations==1">
                                    <label>Días de distancia entre reservaciones</label>
                                    <input type="number" class="form-control"
                                           ng-model="vm.commonArea.distanceBetweenReservations"
                                           required
                                    />
                                </md-input-container>
                            </div>
                            <div class="col-md-12 col-sm-12 col-xs-12 no-padding">
                                <md-input-container class="md-block">
                                    <div style="margin-top: 25px!important;">
                                        <label>Tiene el área común límite de reservaciones por periodo?</label>
                                    </div>
                                    <div class="col-md-12 no-padding" style="margin-top: 13px;">
                                        <md-radio-group style="padding-top: 25px!important;"
                                                        ng-model="vm.commonArea.hasReservationsLimit">
                                            <md-radio-button value="1"
                                                             class="col-md-2 col-xs-4  outline-none md-primary">Si
                                            </md-radio-button>
                                            <md-radio-button value="0" class="col-md-2 col-xs-4  outline-none"> No
                                            </md-radio-button>

                                        </md-radio-group>

                                    </div>
                                </md-input-container>
                                <md-input-container class="md-block margin-top-20 col-md-12 no-padding"
                                                    ng-if="vm.commonArea.hasReservationsLimit==1">
                                    <label>Cantidad de reservaciones por periodo</label>
                                    <input type="number" class="form-control"
                                           ng-model="vm.commonArea.periodTimes"
                                           required
                                    />
                                </md-input-container>
                                <md-input-container class="md-block margin-top-20 col-md-12 no-padding"
                                                    ng-if="vm.commonArea.hasReservationsLimit==1">
                                    <label>Duración del periodo en meses</label>
                                    <input type="number" class="form-control"
                                           ng-model="vm.commonArea.periodMonthEnd"
                                           required
                                    />
                                </md-input-container>

                                <md-input-container class="md-block margin-top-20 col-md-12 no-padding"  ng-if="vm.commonArea.hasReservationsLimit==1">
                                    <label>Fecha de inicio del periodo</label>
                                    <md-datepicker class="datePicker" readonlydatepicker  required ng-model="vm.commonArea.periodBegin" md-hide-icons="calendar"
                                                   md-open-on-focus
                                                   required></md-datepicker>
                                </md-input-container>

                            </div>
                        </div>
                    </div>
                </div>
                <div layout="row" class="white-bg" layout-align="end center" hide-sm hide-xs>

                    <md-button type="button" ng-click="back()"
                               class="md-warn md-raised">Cancelar
                    </md-button>
                    <md-button class="md-primary md-raised" ng-disabled="form.$invalid" type="submit">
                        {{vm.button}}
                    </md-button>
                </div>
            </form>
        </div>
    </md-content>
</div>

